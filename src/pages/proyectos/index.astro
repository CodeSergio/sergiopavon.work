---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects')).sort((a, b) => b.data.year - a.data.year);
---

<BaseLayout title="Proyectos | Sergio Maximiliano Pavón" description="Portafolio de proyectos para demostrar habilidades relevantes en 2026: backend, datos, automatización y calidad.">
  <header class="space-y-3">
    <h1 class="font-display text-4xl">Proyectos</h1>
    <p class="max-w-prose text-[var(--muted)]">
      Proyectos diseñados para demostrar criterio técnico: rendimiento, confiabilidad, integridad de datos y operación.
    </p>
  </header>

  <section class="mt-8 grid gap-3 sm:grid-cols-2" aria-label="Listado de proyectos">
    {projects.map((p) => (
      <article class="rounded-2xl border border-[var(--border)] bg-[var(--card)] p-4">
        <h2 class="font-display text-lg leading-snug">{p.data.title}</h2>
        <div class="mt-3 flex flex-col gap-3 sm:flex-row sm:items-start">
          {p.data.cover && (
            <img
              src={p.data.cover}
              alt={p.data.coverAlt ?? `Miniatura: ${p.data.title}`}
              class="h-20 w-32 shrink-0 rounded-xl border border-[var(--border)] object-cover"
              loading="lazy"
            />
          )}
          <div class="min-w-0">
            <p class="text-sm text-[var(--muted)]">{p.data.highlights[0] ?? ''}</p>
            <p class="mt-2 text-xs tracking-wide text-[var(--muted)]">{p.data.year} • {p.data.stack.join(' • ')}</p>
            <div class="mt-3">
              <a class="btn btn-secondary" href={`/proyectos/${p.slug}`}>Ver proyecto</a>
            </div>
          </div>
        </div>
      </article>
    ))}
  </section>
</BaseLayout>
